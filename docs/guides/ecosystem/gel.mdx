---
title: åœ¨ Bun ä¸­ä½¿ç”¨ Gel
sidebarTitle: Gel ä¸ Bun
mode: center
---

Gelï¼ˆå‰èº«ä¸º EdgeDBï¼‰æ˜¯ä¸€æ¬¾ç”± Postgres æ”¯æŒçš„å›¾å…³ç³»æ•°æ®åº“ã€‚å®ƒæä¾›å£°æ˜å¼æ¨¡å¼è¯­è¨€ã€è¿ç§»ç³»ç»Ÿå’Œé¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­è¨€ï¼ŒåŒæ—¶è¿˜æ”¯æŒåŸç”Ÿ SQL æŸ¥è¯¢ã€‚å®ƒåœ¨æ•°æ®åº“å±‚é¢è§£å†³äº†å¯¹è±¡å…³ç³»æ˜ å°„é—®é¢˜ï¼Œå…å»äº†åœ¨åº”ç”¨ä»£ç ä¸­ä½¿ç”¨ ORM åº“çš„å¿…è¦ã€‚

---

é¦–å…ˆï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…ï¼Œ[è¯·å®‰è£… Gel](https://docs.geldata.com/learn/installation)ã€‚

<CodeGroup>

```sh Linux/macOS terminal icon="terminal"
curl https://www.geldata.com/sh --proto "=https" -sSf1 | sh
```

```sh Windows terminal icon="windows"
irm https://www.geldata.com/ps1 | iex
```

```sh Homebrew terminal icon="terminal"
brew install geldata/tap/gel-cli
```

</CodeGroup>

---

ä½¿ç”¨ `bun init` åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ã€‚

```sh terminal icon="terminal"
mkdir my-edgedb-app
cd my-edgedb-app
bun init -y
```

---

æˆ‘ä»¬å°†ä½¿ç”¨ Gel CLI æ¥ä¸ºé¡¹ç›®åˆå§‹åŒ–ä¸€ä¸ª Gel å®ä¾‹ã€‚è¿™å°†åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª `gel.toml` æ–‡ä»¶ã€‚

```sh terminal icon="terminal"
gel project init
```

```txt
åœ¨ `/Users/colinmcd94/Documents/bun/fun/examples/my-gel-app` æˆ–å…¶ä¸Šçº§ç›®å½•æœªæ‰¾åˆ° `gel.toml`
æ˜¯å¦è¦åˆå§‹åŒ–ä¸€ä¸ªæ–°é¡¹ç›®ï¼Ÿ[Y/n]
> Y
è¯·ä¸ºæ­¤é¡¹ç›®æŒ‡å®šè¦ä½¿ç”¨çš„ Gel å®ä¾‹åç§° [é»˜è®¤: my_gel_app]:
> my_gel_app
æ­£åœ¨æ£€æŸ¥ Gel ç‰ˆæœ¬...
è¯·ä¸ºæ­¤é¡¹ç›®æŒ‡å®šè¦ä½¿ç”¨çš„ Gel ç‰ˆæœ¬ [é»˜è®¤: x.y]:
> x.y
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¡¹ç›®ç›®å½•           â”‚ /Users/colinmcd94/Documents/bun/fun/examples/my-gel-app         â”‚
â”‚ é¡¹ç›®é…ç½®           â”‚ /Users/colinmcd94/Documents/bun/fun/examples/my-gel-app/gel.tomlâ”‚
â”‚ æ¨¡å¼ç›®å½•ï¼ˆç©ºï¼‰     â”‚ /Users/colinmcd94/Documents/bun/fun/examples/my-gel-app/dbschemaâ”‚
â”‚ å®‰è£…æ–¹å¼           â”‚ ä¾¿æºåŒ…                                                         â”‚
â”‚ ç‰ˆæœ¬               â”‚ x.y+6d5921b                                                    â”‚
â”‚ å®ä¾‹åç§°           â”‚ my_gel_app                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ç‰ˆæœ¬ x.y+6d5921b å·²ä¸‹è½½
æ­£åœ¨åˆå§‹åŒ– Gel å®ä¾‹...
æ­£åœ¨åº”ç”¨è¿ç§»...
æ‰€æœ‰å†…å®¹å‡ä¸ºæœ€æ–°ã€‚ç‰ˆæœ¬ initial
é¡¹ç›®å·²åˆå§‹åŒ–ã€‚
è¿æ¥åˆ° my_gel_appï¼Œè¯·è¿è¡Œ `gel`
```

---

ä¸ºäº†æ£€æŸ¥æ•°æ®åº“æ˜¯å¦æ­£åœ¨è¿è¡Œï¼Œæ‰“å¼€ REPL å¹¶æ‰§è¡Œç®€å•æŸ¥è¯¢ã€‚

```sh terminal icon="terminal"
gel
gel> select 1 + 1;
```

```txt
2
```

ç„¶åè¿è¡Œ `\quit` é€€å‡º REPLã€‚

```sh terminal icon="terminal"
gel> \quit
```

---

é¡¹ç›®åˆå§‹åŒ–å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæ¨¡å¼ã€‚`gel project init` å‘½ä»¤å·²åˆ›å»ºäº†ä¸€ä¸ª `dbschema/default.esdl` æ–‡ä»¶ç”¨äºä¿å­˜æˆ‘ä»¬çš„æ¨¡å¼å®šä¹‰ã€‚

```txt File Tree icon="folder-tree"
dbschema
â”œâ”€â”€ default.esdl
â””â”€â”€ migrations
```

---

æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œç²˜è´´ä»¥ä¸‹å†…å®¹ã€‚

```ts default.esdl icon="file-code"
module default {
  type Movie {
    required title: str;
    releaseYear: int64;
  }
};
```

---

ç„¶åç”Ÿæˆå¹¶åº”ç”¨ä¸€ä¸ªåˆå§‹è¿ç§»ã€‚

```sh terminal icon="terminal"
gel migration create
```

```txt
å·²åˆ›å»º /Users/colinmcd94/Documents/bun/fun/examples/my-gel-app/dbschema/migrations/00001.edgeqlï¼ŒID: m1uwekrn4ni4qs7ul7hfar4xemm5kkxlpswolcoyqj3xdhweomwjrq
```

```sh terminal icon="terminal"
gel migrate
```

```txt
å·²åº”ç”¨ m1uwekrn4ni4qs7ul7hfar4xemm5kkxlpswolcoyqj3xdhweomwjrq (00001.edgeql)
```

---

åº”ç”¨æ¨¡å¼åï¼Œæˆ‘ä»¬é€šè¿‡ Gel çš„ JavaScript å®¢æˆ·ç«¯åº“æ‰§è¡Œä¸€äº›æŸ¥è¯¢ã€‚å®‰è£…å®¢æˆ·ç«¯åº“å’Œ Gel çš„ä»£ç ç”Ÿæˆ CLIï¼Œåˆ›å»ºä¸€ä¸ª `seed.ts` æ–‡ä»¶ã€‚

```sh terminal icon="terminal"
bun add gel
bun add -D @gel/generate
touch seed.ts
```

---

å°†ä»¥ä¸‹ä»£ç ç²˜è´´åˆ° `seed.ts`ã€‚

å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨è¿æ¥æ•°æ®åº“ã€‚æˆ‘ä»¬ä½¿ç”¨ `.execute()` æ–¹æ³•æ’å…¥å‡ éƒ¨ç”µå½±ã€‚è¿™é‡Œä½¿ç”¨ EdgeQL çš„ `for` è¡¨è¾¾å¼å°†å¤šä¸ªæ’å…¥æ“ä½œåˆå¹¶ä¸ºä¸€ä¸ªä¼˜åŒ–æŸ¥è¯¢ã€‚

```ts seed.ts icon="/icons/typescript.svg"
import { createClient } from "gel";

const client = createClient();

const INSERT_MOVIE = `
  with movies := <array<tuple<title: str, year: int64>>>$movies
  for movie in array_unpack(movies) union (
    insert Movie {
      title := movie.title,
      releaseYear := movie.year,
    }
  )
`;

const movies = [
  { title: "The Matrix", year: 1999 },
  { title: "The Matrix Reloaded", year: 2003 },
  { title: "The Matrix Revolutions", year: 2003 },
];

await client.execute(INSERT_MOVIE, { movies });

console.log(`ç§å­æ•°æ®æ’å…¥å®Œæˆã€‚`);
process.exit();
```

---

ç„¶åä½¿ç”¨ Bun è¿è¡Œæ­¤æ–‡ä»¶ã€‚

```sh terminal icon="terminal"
bun run seed.ts
```

```txt
ç§å­æ•°æ®æ’å…¥å®Œæˆã€‚
```

---

Gel ä¸º TypeScript æä¾›äº†å¤šç§ä»£ç ç”Ÿæˆå·¥å…·ã€‚ä¸ºäº†ç±»å‹å®‰å…¨åœ°æŸ¥è¯¢æˆ‘ä»¬çš„æ–°æ•°æ®åº“ï¼Œä½¿ç”¨ `@gel/generate` ç”Ÿæˆ EdgeQL æŸ¥è¯¢æ„å»ºå™¨ã€‚

```sh terminal icon="terminal"
bunx @gel/generate edgeql-js
```

```txt
æ­£åœ¨ç”ŸæˆæŸ¥è¯¢æ„å»ºå™¨...
æ£€æµ‹åˆ° tsconfig.jsonï¼Œæ­£åœ¨ç”Ÿæˆ TypeScript æ–‡ä»¶ã€‚
   å¦‚éœ€è¦†ç›–æ­¤è¡Œä¸ºï¼Œè¯·ä½¿ç”¨ --target æ ‡å¿—ã€‚
   è¿è¡Œ `npx @edgedb/generate --help` è·å–å®Œæ•´é€‰é¡¹ã€‚
æ­£åœ¨æ£€æŸ¥æ•°æ®åº“æ¨¡å¼...
æ­£åœ¨å†™å…¥æ–‡ä»¶åˆ° ./dbschema/edgeql-js
ç”Ÿæˆå®Œæˆï¼ğŸ¤˜
ä¸å»ºè®®å°†ç”Ÿæˆçš„æŸ¥è¯¢æ„å»ºå™¨çº³å…¥ç‰ˆæœ¬æ§åˆ¶ã€‚
æ˜¯å¦è¦å°†æŸ¥è¯¢æ„å»ºå™¨ç›®å½•æ·»åŠ åˆ° .gitignoreï¼Ÿå°†æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

   dbschema/edgeql-js

[y/n]ï¼ˆç•™ç©ºä¸º"y"ï¼‰
> y
```

---

åœ¨ `index.ts` ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä» `./dbschema/edgeql-js` å¯¼å…¥ç”Ÿæˆçš„æŸ¥è¯¢æ„å»ºå™¨ï¼Œç¼–å†™ä¸€ä¸ªç®€å•çš„ select æŸ¥è¯¢ã€‚

```ts index.ts icon="/icons/typescript.svg"
import { createClient } from "gel";
import e from "./dbschema/edgeql-js";

const client = createClient();

const query = e.select(e.Movie, () => ({
  title: true,
  releaseYear: true,
}));

const results = await query.run(client);
console.log(results);

results; // { title: string, releaseYear: number | null }[]
```

---

è¿è¡Œè¯¥æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ’å…¥çš„ç”µå½±åˆ—è¡¨ã€‚

```sh terminal icon="terminal"
bun run index.ts
```

```txt
[
  {
    title: "The Matrix",
    releaseYear: 1999
  }, {
    title: "The Matrix Reloaded",
    releaseYear: 2003
  }, {
    title: "The Matrix Revolutions",
    releaseYear: 2003
  }
]
```

---

æ›´å¤šå®Œæ•´æ–‡æ¡£ï¼Œè¯·å‚è€ƒ [Gel æ–‡æ¡£](https://docs.geldata.com/)ã€‚
